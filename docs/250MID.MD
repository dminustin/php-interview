# Middle

## Общие вопросы

### Как передаются переменные (по значению или по ссылке)?

Согласно документации PHP, они передаются по значению. По умолчанию аргументы функций передаются по значению (таким образом, если значение аргумента внутри функции изменяется, оно не изменяется за пределами функции). Чтобы функция могла изменять свои аргументы, они должны передаваться по ссылке.

Объекты, переданные внутрь какой-то функции в качестве аргументов, ведут себя точно также – если внутри функции мы меняем внутреннее состояние объекта, то снаружи увидим это изменённое состояние. Отличие в том, что в сигнатуре функции не нужно ставить амперсанд перед параметром-объектом.

### Какие процессы происходят, когда пользователь вводит в браузере URL?

todo https://habr.com/ru/company/htmlacademy/blog/254825/

### Что такое вариативная функция или splat-оператор?

Вариативная функция - это функция с переменным числом аргументов

function listNumbers (...$numbers)

### Что такое OWASP?

Open Web Application Security Project (OWASP) — это методология, открытый проект(сообщество) обеспечения безопасности веб-приложений.

В общем, есть несколько самых распространенных уязвимостей в PHP.

SQL injection. Метод заключается в вставке фрагмента SQL-инструкции в поля для ввода пользователем. Обычно для защиты можно ограничиться использованием PDO для работы с базой. В часности, использовать prepared statements.

XSS уязвимость (Cross Site Scripting). На клиенте внедряется свой js-код, который передается через форму (текстовое поле) на сервер. Далее это js может выполняться на других клиентах, которые открыли эту страничку. Таким образом можно отслеживать события на странице и собирать данные или перенаправлять на вредоносный сайт. Чтоб этого не допустить, нужно фильтровать(экранировать) данные, которые приходят от пользователя.

Провтыки в исходном коде, структуре проекта. Это могут быть конфигурационные файлы(например .env), которые открыты для пользователей. Нужно не допускать хранения важных файлов в каталогах доступных для всех пользователей (каталоги по типу /public или /web).

### Что такое идемпотентные методы? Какие HTTP-методы являются идемпотентными для REST?

Метод HTTP является идемпотентным, если повторный идентичный запрос, сделанный один или несколько раз подряд, имеет один и тот же эффект, не изменяющий состояние сервера. Другими словами, идемпотентный метод не должен иметь никаких побочных эффектов (side-effects), кроме сбора статистики или подобных операций.

Методы GET, HEAD, OPTIONS и TRACE определены как безопасные, что также делает их идемпотентными.

### Что такое stateless?

Stateless - состояние не хранится на сервере. Т. е. в каждом новом запросе мы передаём свой логин/пароль (если в приложении есть авторизация), а также данные для запроса.

Statefull - на сервере открывается сессия. Благодаря этому нам не надо постоянно отправлять на сервер логин/пароль. И не надо отсылать какие-то дополнительные данные (например выбранную локализацию), они хранятся в сессии.

### SOAP vs REST. В чем разница?

SOAP API передает SOAP сообщения в стандартном формате XML из-за его statefulness, в то время как REST API не придерживается формата данных из-за его stateless. SOAP работает с WSDL благодаря формату XML, в то время как REST API использует такие запросы, как GET, PUT, POST, и DELETE.

### Какие методы авторизации используют для построения API?

- API ключ
- Basic Auth.
- HMAC.
- OAuth 2.0.

### Что может содержать интерфейс?

Интерфейсы могут содержать лишь сигнатуры методов - наазвания функций и список параметров в скобках, после которого идет точка с запятой. Так, в данном случае объявлен метод send() . Он не имеет реализации - конкретную реализацию определит класс, который реализует этот интерфейс.

### Класс содержит свойство, которое, в свою очередь, является объектом. Что будет содержать это свойство в клонированном объекте: ссылку на тот же дочерний объект или копию дочернего объекта? Что нужно сделать, чтобы это изменить?

### Что такое Mock? Где используют и зачем?

Mock-объект — в объектно-ориентированном программировании — тип объектов, реализующих заданные аспекты моделируемого программного окружения.

Mock-объекты активно используются в разработке через тестирование.

### Что такое PSR?

PSR (PHP Standards Recommendations) — это набор рекомендаций по программированию на языке PHP. Основное назначение — предоставить проверенные общие концепции, чтобы сделать разработку простой и удобной, повысить надежность и работоспособность продуктов.

### Опишите реализацию одного из шаблонов проектирования.

### Что такое Redis?

Redis — резидентная система управления базами данных класса NoSQL с открытым исходным кодом, работающая со структурами данных типа «ключ — значение». Используется как для баз данных, так и для реализации кэшей, брокеров сообщений. Ориентирована на достижение максимальной производительности на атомарных операциях.

### Как хранятся данные в Redis / Memcached?

В оперативной памяти

### Расскажите о целесообразности применения Redis / Memcached для кэширования. Каковы плюсы и минусы?

Начнем со сходств. И Memcached, и Redis служат в качестве размещающихся в оперативной памяти хранилищ данных с ключом, хотя Redis более точно описывается как хранилище структуры данных. Как Memcached, так и Redis относятся к семейству решений для управления данными NoSQL, и оба они основаны на модели данных с ключевыми значениями. Они сохраняют все данные в ОЗУ (памяти), что, конечно же, делает их чрезвычайно полезными в качестве слоя кеширования. С точки зрения производительности два хранилища данных также очень похожи, демонстрируя почти идентичные характеристики (и показатели) в отношении пропускной способности и латентности.

Поскольку Redis новее и имеет больше возможностей, чем Memcached, Redis почти всегда лучший выбор. Тем не менее, Memcached может быть предпочтительнее при кэшировании относительно небольших и статических данных, таких как фрагменты кода HTML. Управление внутренней памятью Memcached, хотя и не столь сложное, как решение Redis, более эффективно в простейших случаях использования, поскольку оно потребляет сравнительно меньше ресурсов памяти для метаданных. Строки (единственный тип данных, поддерживаемый Memcached) идеально подходят для хранения данных, которые только читаются, потому что строки не требуют дальнейшей обработки.

Тем не менее, эффективность управления памятью Memcached быстро уменьшается, когда размер данных является динамическим, после чего память Memcached может стать фрагментированной. Кроме того, большие наборы данных часто включают в себя сериализованные данные, которые всегда требуют большего пространства для хранения. Хотя Memcached эффективно ограничивается хранением данных в его сериализованной форме, структуры данных в Redis могут сохранять любой аспект данных изначально, тем самым уменьшая накладные расходы на сериализацию.

Второй сценарий, в котором Memcached имеет преимущество перед Redis, находится в масштабировании. Поскольку Memcached многопоточен, вы можете легко увеличить его, предоставив ему больше вычислительных ресурсов, но вы потеряете часть или все кэшированные данные (в зависимости от того, используете ли вы постоянное хеширование). Redis, который в основном однопоточный, может масштабироваться горизонтально посредством кластеризации без потери данных. Кластеризация представляет собой эффективное масштабирующее решение, но его сравнительно сложно создавать и управлять им.

Кэши используют механизм, называемый выселением данных (синоним: вытеснение данных), чтобы освободить место для новых данных, удалив старые данные из памяти. Механизм выселения данных Memcached использует алгоритм Least Recent Used (LRU) и несколько произвольно вытесняет данные, похожие по размеру на новые данные.

### Назовите различия между nginx и Apache.

Apache работает во всех операционных системах, таких как UNIX, Linux или BSD, и полностью поддерживает Microsoft Windows. Nginx также работает на нескольких современных Unix-подобных системах и поддерживает Windows, но его производительность в Windows не так стабильна, как на платформах UNIX.

Одно из самых существенных отличий между Apache и Nginx состоит в том как они обрабатывают соединения и отвечают на различные виды трафика.

Если рассматривать жизненные примеры, то основные различия между Apache и Nginx в том как они обрабатывают запросы к статическому и динамическому контенту.

Apache может раздавать статический контент используя стандартные file-based методы. Производительность таких операций зависит от выбранного MPM.

Apache также может раздавать динамический контент встраивая интерпретатор нужного языка в каждого воркера. Это позволяет обрабатывать запросы к динамическому содержимому средствами самого веб-сервера и не полагаться на внешние компоненты. Интерпретаторы языков могут быть подключены к Apache с помощью динамически загружаемых модулей.

Возможность обрабатывать динамический контент средствами самого Apache упрощает конфигурирование. Нет необходимости настраивать взаимодействие с дополнительным софтом, динамический модуль может быть легко отключен в случае изменившихся требований.

Nginx не имеет возможности самостоятельно обрабатывать запросы к динамическому контенту. Для обработки запросов к PHP или другому динамическому контенту Nginx должен передать запрос внешнему процессору для исполнения, подождать пока ответ будет сгенерирован и получить его. Затем результат может быть отправлен клиенту.

Для администраторов это означает, что нужно настроить взаимодействие Nginx с таким процессором используя один из протоколов, который известен Nginx'у (http, FastCGI, SCGI, uWSGI, memcache). Это может немного усложнить процесс настройки, в особенности когда вы будете пытаться предугадать какое число соединений разрешить, так как будет использоваться дополнительное соединение с процессором на каждый пользовательский запрос.

Однако, этот метод имеет и свои преимущества. Так как интерпретатор не встроен в каждого воркера, то оверхед, связанный с этим, будет иметь место только при запросах к динамическому контенту. Статический контент будет возвращен клиенту простым способом и запросы к интерпретатору будут выполняться только тогда когда они нужны. Apache тоже может работать в такой манере, но тогда это лишит его всех преимуществ описанных в предыдущем разделе.

### Что такое Opcash? Как он работает?

Zend Opcache – это расширение PHP, предназначенное для повышения производительности PHP, сокращения времени загрузки веб-страниц и уменьшения нагрузки на сервере.

Производительность достигается путем компиляции кода PHP файлов при первом обращении к ним. В результате при следующем доступе сервер не тратит ресурсы на повторное чтение и компиляцию php файла, а отдает готовый результат из кэша opcache. Т.е. opcache дает хорошие результаты для cms/файлов php скриптов, код которых редко изменяется.

### Что такое JIT? Как он работает?

JIT-компиляция (англ. Just-in-Time, компиляция «точно в нужное время»), динамическая компиляция (англ. dynamic translation) — технология увеличения производительности программных систем, использующих байт-код, путём компиляции байт-кода в машинный код или в другой формат непосредственно во время работы программы.

Упрощая вещи: когда JIT работает должным образом, ваш код не будет выполняться через Zend VM, вместо этого он будет выполняться непосредственно как набор инструкций уровня процессора.

### Зачем нужно ключевое слово final?

PHP предоставляет ключевое слово final , разместив которое перед объявлениями методов или констант класса, можно предотвратить их переопределение в дочерних классах. Если же сам класс определяется с этим ключевым словом, то он не сможет быть унаследован.

### Что такое SOLID, DRY, KISS, YAGNI?

DRY - Don`t repeat yourself

это принцип разработки программного обеспечения, нацеленный на снижение повторения информации различного рода, особенно в системах со множеством слоёв абстрагирования.

KISS - keep it simple stupid

Делай код проще. принцип проектирования, принятый в ВМС США в 1960. Принцип KISS утверждает, что большинство систем работают лучше всего, если они остаются простыми, а не усложняются. Поэтому в области проектирования простота должна быть одной из ключевых целей, и следует избегать ненужной сложности.

YAGNI — процесс и принцип проектирования ПО, при котором в качестве основной цели и/или ценности декларируется отказ от избыточной функциональности, — то есть отказ добавления функциональности, в которой нет непосредственной надобности

### Назовите паттерны проектирования, с которыми приходилось работать.

### Что такое простая фабрика?

### Что такое Service Layer и где его следует применять?

Сервисный слой (Service layer) — это шаблон проектирования, который поможет вам абстрагировать логику от логики предметной области (domain logic), при необходимости использования разных интерфейсов. На самом деле вы делегируете логику приложения общему сервису (сервисному слою) и обслуживаете только один класс.

Если простыми словами, то вы сосредотачиваете логику вашего приложения в одном (или нескольких) классе-сервисе, а в своих контроллерах обращаетесь к нему. Это избавляет от дублирования кода в разных участках системы, делая ваш контроллер действительно соответствующим букве S из SOLID.

### Как устроен Singleton и почему его считают антипаттерном?

Singleton относится к порождающим паттернам. Его дословный перевод – одиночка.  Этот паттерн гарантирует, что у класса есть только один объект (один экземпляр класса) и к этому объекту предоставляется глобальная точка доступа.

- Синглтон нарушает SRP (Single Responsibility Principle) — класс синглтона, помимо того чтобы выполнять свои непосредственные обязанности, занимается еще и контролированием количества своих экземпляров.
- Глобальное состояние. Про вред глобальных переменных вроде бы уже все знают, но тут та же самая проблема. Когда мы получаем доступ к экземпляру класса, мы не знаем текущее состояние этого класса, и кто и когда его менял, и это состояние может быть вовсе не таким, как ожидается. Иными словами, корректность работы с синглтоном зависит от порядка обращений к нему, что вызывает неявную зависимость подсистем друг от друга и, как следствие, серьезно усложняет разработку.
- Зависимость обычного класса от синглтона не видна в публичном контракте класса. Так как обычно экземпляр синглтона не передается в параметрах метода, а получается напрямую, через GetInstance(), то для выявления зависимости класса от синглтона надо залезть в тело каждого метода — просто просмотреть публичный контракт объекта недостаточно.
- Наличие синглтона понижает тестируемость приложения в целом и классов, которые используют синглтон, в частности. Во-первых, вместо синглтона нельзя подпихнуть Mock-объект, а во-вторых, если синглтон имеет интерфейс для изменения своего состояния, то тесты начинают зависеть друг от друга. Говоря же проще — синглтон повышает связность, и все вышеперечисленное, в том или ином виде, есть следствие повышения связности.

### Что такое идемпотентность?

Идемпотентность — свойство объекта или операции при повторном применении операции к объекту давать тот же результат, что и при первом.

### Опишите жизненный цикл HTTP-запроса.

### Что такое куча и стек?

Стек — это область оперативной памяти, которая создаётся для каждого потока. Он работает в порядке LIFO (Last In, First Out),  то есть последний добавленный в стек кусок памяти будет первым в очереди на вывод из стека. Каждый раз, когда функция объявляет новую переменную, она добавляется в стек, а когда эта переменная пропадает из области видимости (например, когда функция заканчивается), она автоматически удаляется из стека. Когда стековая переменная освобождается, эта область памяти становится доступной для других стековых переменных.

Куча — это хранилище памяти, также расположенное в ОЗУ, которое допускает динамическое выделение памяти и не работает по принципу стека: это просто склад для ваших переменных. Когда вы выделяете в куче участок памяти для хранения переменной, к ней можно обратиться не только в потоке, но и во всем приложении. Именно так определяются глобальные переменные. По завершении приложения все выделенные участки памяти освобождаются. Размер кучи задаётся при запуске приложения, но, в отличие от стека, он ограничен лишь физически, и это позволяет создавать динамические переменные.

### Что такое рефлексия?

PHP включает в себя полноценный Reflection API, который предоставляет возможность проводить интроспекцию классов, интерфейсов, функций, методов и модулей. Кроме того, Reflection API позволяет получать doc-блоки комментариев функций, классов и методов.

- для аннотаций (получения данных из phpdoc)
- IoC-контейнеры, например, в Laravel.
- позволяет тестировать private методы классов напрямую.

рефлексия всего лишь позволяет программе отслеживать свою структуру и поведение во время выполнения.

### Что такое хэш-функция и где она используется?

Хеширование — операция, которая преобразует любые входные данные в строку (реже число) фиксированной длины. Функция, реализующая алгоритм преобразования, называется "хеш-функцией", а результат называют "хешем" или "хеш-суммой". Наиболее известны CRC32, MD5 и SHA (много разновидностей).

Например, для хеширования паролей, чтобы не хранить их в явном виде. Развернуть пароль из хеша, особенно, если хеш создан по сложному алгоритму, очень сложно.

Так же, можно использовать хеши для уникализации каких-либо данных, вместо того, чтобы сравнивать большие строки, можно сравнивать их заранее подготовленные хеши.

### Как применяются очереди в РНР?

### Как в общих чертах работает OPcache?

### Что такое TDD?

Разработка через тестирование — техника разработки программного обеспечения, которая основывается на повторении очень коротких циклов разработки: сначала пишется тест, покрывающий желаемое изменение, затем пишется код, который позволит пройти тест, и под конец проводится рефакторинг нового кода к соответствующим

### Чем отличаются модульные тесты от интеграционных?

Тест интеграции отличается от модульного теста тем, что он позволяет двум или более программным компонентам работать совместно, также называемый интеграцией. Эти тесты работают в более широком спектре тестируемой системы, в то время как модульные тесты сосредоточены на отдельных компонентах.

### Что такое трейты? Как применять на практике?

Трейты — альтернативный механизм переиспользования общего кода в разных классах. Он устраняет ограничения, которыми обладает наследование и заменяет его. Трейты похожи на абстрактные классы. Они реализуют какую-то общую функциональность и с ними нельзя работать напрямую.

### Как разрешить конфликты при использовании trait?

Ошибки могут быть когда подключается несколько трейтов, содержащие одни и те же методы. Или когда класс наследует у другого класса с подключением трейта, который уже был подключен в родительском классе.
Для разрешения конфликтов необходимо использовать оператор insteadof при подключении трейтов для того, чтобы точно выбрать один из конфликтных методов.
Внутри тела «use» мы использовали ключевое слово insteadof, слева от которого указывается трейт, метод которого будем использовать и имя самого метода, которые разделяются двойным двоеточием. В правой части указывается имя трейта, метод которого должен быть заменён.

Если же второй одноименный метод (из другого трейта) нам тоже нужен, то можно применить псевдоним имени используя ключевое слово as

### Как работает автозагрузка классов?

PHP содержит специальный механизм автозагрузки классов. Этот механизм работает так: если интерпретатор наталкивается на использование класса, то он проверяет, определили ли вы автозагрузчик классов, и, если определили, то вызывает его (пример). Composer определяет такой загрузчик автоматически.

Большинство разработчиков объектно-ориентированных приложений используют такое соглашение именования файлов, в котором каждый класс хранится в отдельно созданном для него файле. Одна из самых больших неприятностей - необходимость писать в начале каждого скрипта длинный список подгружаемых файлов (по одному для каждого класса).

Функция spl_autoload_register() позволяет зарегистрировать необходимое количество автозагрузчиков для автоматической загрузки классов и интерфейсов, если они в настоящее время не определены. Регистрируя автозагрузчики, PHP получает последний шанс для интерпретатора загрузить класс прежде, чем он закончит выполнение скрипта с ошибкой.

Любая конструкция, подобная классу может быть автоматически загружена таким же образом, включая классы, интерфейсы, трейты и перечисления.

### В чем разница между стеком и очередью?

Очереди очень похожи на стеки. Они также не дают доступа к произвольному элементу, но, в отличие от стека, элементы кладутся (enqueue) и забираются (dequeue) с разных концов. Такой метод называется «первый вошел, первый вышел» (First-In-First-Out или FIFO).

### Расскажите о Unit Tests (required), Functional Tests (optional). Моки и стаб в PHP.

### Представим ситуацию, в которой нам нужно вызвать частный метод. Как это сделать?

Можно через рефлексию.

### Опишите разницу между PHP-FPM и PHP на сокете.

PHP-FPM - это PHP-реализация FastCGI; PHP-FPM работает как самостоятельный сервер FastCGI, и Apache подключается к серверу с помощью модуля Apache, обычно mod_fcgid или mod_fastcgi. Это лучше, чем запускать PHP через mod_php. В этой конфигурации права доступа и все остальное выполняется в конфигурации PHP.

### Как бы вы реализовали загрузки больших отчетов с большим количеством данных (файлы от 1 гигабайта до N гигабайт).

### Как бы вы импортировали 50-гигабайтный файл xml в базу данных?

### Почему после PHP 5 идет сразу 7, куда делась 6?

в марте 2010 года разработка PHP6 была признана бесперспективной из-за сложностей с поддержкой Юникода.

### Есть ли разница между self и this в PHP?

Статические функции должны использовать только статические переменные.

- self ТОЛЬКО для статических функций, свойств. Но также можно вызвать нестатический метод, КАК СТАТИЧЕСКИЙ через self. Но лучше так не делать, а то папа побьет.
- this ТОЛЬКО для нестатических.
- this требует, чтобы класс был проинстанцирован, self не требует.
- $this - это ССЫЛКА на ТЕКУЩИЙ объект и она нужна, чтобы обратиться к переменной в КОНТЕКСТЕ класса.

### Что такое PuTTY?

свободно распространяемый клиент для различных протоколов удалённого доступа, включая SSH, Telnet, rlogin. Также имеется возможность работы через последовательный порт.

### У нас есть важный PHP-файл, его надо запускать каждые 20 секунд. Как бы вы это сделали?

несколько кронов вида

````php
* * * * * php myscript.php
* * * * * sleep 20 && php myscript.php
* * * * * sleep 40 && php myscript.php
````

### Как расшифровать 644 в правах на файл в Linux?

Для каждой группы пользователей определены свои права доступа. При попытке соединения веб-сервер определяет, к какой группе отнести того или иного юзера. Все они разделяются на:

- «user» (u) — владелец файла;
- «group» (g) — один из членов группы, к которой принадлежит и владелец;
- «others» (o) — все остальные пользователи.

Права доступа к файлам позволяют производить следующие операции с объектами:

- r (read) = 4 — чтение (возможность просмотра содержания);
- w (write) = 2 — запись, перезапись (изменение содержимого), но не удаление;
- x (eXutive) = 1 — исполнение (например, запуск программного файла).    
- нет прав = 0

права складываются

644 = 6(user чтение + запись) + 4 (группа чтение) + 4 (остальные чтение)

## Git

###  В чем разница между merge и rebase?

Согласно официальному руководству Git rebase “повторно применяет коммиты поверх другой базовой ветки”, тогда как merge “объединяет две или более историй разработки”. Иначе говоря, основное отличие между ними в том, что слияние сохраняет историю в первозданном виде, а перебазирование ее перезаписывает.

###  Какой командой можно сделать ресет изменений, не потеряв их?

###  Что такое stash и зачем он нужен?

Команда git stash позволяет на время «сдать в архив» (или отложить) изменения, сделанные в рабочей копии, чтобы вы могли применить их позже. Откладывание изменений полезно, если вам необходимо переключить контекст и вы пока не готовы к созданию коммита.

##Базы данных

### В чем разница между MyISAM i InnoDB? Что в каких случаях лучше применять?

### Как найти и оптимизировать «тяжелые» запросы?

### Какие есть типы индексов?

### Как хранить координаты точки на карте в БД?

### Какие типы индексов бывают в RDBMS?

### Какое свойство полей БД нужно учитывать при выборе типа индекса?

### Когда следует использовать индексы, какие есть преимущества и недостатки?

### Что такое ACID?

### Что такое план выполнения запроса и как его узнать?

### В чем разница между типами данных CHAR и VARCHAR в SQL?

### Каково назначение транзакций? Расскажите о принципе работы.

### Назовите 3-4 нормальные формы реляционных БД.

### Каково назначение репликации? Какие есть типы связей и в чем разница между ними?

### Что такое индексация? Какие есть типы индексов? Какой смысл их использовать?

### Что такое полнотекстовый поиск в MySQL? Как он реализуется?

### Что такое cursor в MySQL-процедурах?

### Расскажите о RabbitMQ или Gearman.

### Что знаете о Solr / ElasticSearch?

### Что такое Дедлок MySQL?

### Влияет ли порядок JOIN на план выполнения MySQL-запроса?

## Laravel
### Как и какие запросы формируются при использовании метода with()?

### Чем отличаются методы with() и load()?